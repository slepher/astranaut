# Local CI / Erlang Compatibility Verification Tool

## 简介 / Introduction
这是一个基于 Docker 的本地 CI 工具，用于在隔离环境中验证项目对特定 Erlang/OTP 版本的兼容性。
它允许开发者在本地模拟 CI 流程，运行 Common Test 和生成覆盖率报告，而无需污染本地开发环境。

This is a Docker-based local CI tool designed to verify project compatibility with specific Erlang/OTP versions in an isolated environment.
It allows developers to simulate CI processes locally, running Common Tests and generating coverage reports without polluting the local development environment.

---

## 免责声明 / Disclaimer

**中文:**
1. 本工具及其脚本代码由 AI 生成。
2. 作者 **已在** Windows (PowerShell + Docker Desktop) 环境下验证过 PowerShell 版本脚本 (`.ps1`) 的功能，确认可正常使用。
3. 作者 **未在** 原生 Linux 环境下验证 Bash 版本脚本 (`.sh`)。虽然逻辑与 PowerShell 版本保持一致，但在 Linux 下使用时请务必自行检查。
4. 使用此工具产生的任何副作用（如 Docker 镜像占用空间等）需自行管理。

**English:**
1. This tool and its scripts were generated by AI.
2. The author **HAS verified** the PowerShell scripts (`.ps1`) in a Windows (PowerShell + Docker Desktop) environment and confirmed they function correctly.
3. The author **HAS NOT tested** the Bash scripts (`.sh`) in a native Linux environment. While the logic mirrors the PowerShell version, please verify them before use on Linux.
4. Any side effects caused by this tool (such as disk space usage by Docker images, etc.) must be managed by the user.

---

## 快速开始 / Quick Start

### 0. 准备工作 / Prerequisites
* 安装 Docker (Docker Desktop or Docker Engine).
* **(Windows 用户)** 如果脚本无法运行，请解锁 PowerShell 执行权限。

### 1. 配置 / Configuration
项目提供了一个示例配置文件 `ci_scripts/ci-env.conf.example`。
A sample configuration file `ci_scripts/ci-env.conf.example` is provided.

**强烈建议手动复制并配置 / Highly Recommended:**
请将示例文件复制为 `ci-env.conf`，并根据你的需求修改（例如设置需要测试的 Erlang 版本列表）。
Please manually copy it to `ci-env.conf` and modify it as needed (e.g., set the list of Erlang versions to test).

### 2. 构建镜像 / Build Image
运行构建脚本以生成 Docker 镜像。脚本支持批量构建配置文件中定义的所有版本。每个 Erlang 版本只需构建一次。
Run the build script to generate Docker images. Supports batch building for all versions defined in the config. Run once per Erlang version.

* **注意 / Note:** 如果你忘记创建 `ci-env.conf`，构建脚本会自动从 `example` 文件复制一份默认配置并继续运行，但这可能不符合你的定制需求。
* **Note:** If `ci-env.conf` is missing, the script will automatically copy it from the `example` file and proceed with default settings, which might not match your custom needs.

**命令 / Command:**
* **Windows:** `.\ci_scripts\build.ps1`
* **Linux:** `./ci_scripts/build.sh`

### 3. 运行测试 / Run Tests
修改源码后 **无需** 重新构建镜像，直接运行即可。
No need to rebuild image after changing source code.

* **Windows:** `.\ci_scripts\run.ps1`
* **Linux:** `./ci_scripts/run.sh`

脚本运行结束后，会自动启动一个 Web 服务器展示所有版本的测试日志和覆盖率报告。

### 4. 查看日志 / View Logs
如果你关闭了测试窗口，可以随时使用此脚本重新查看最近一次的报告。
Use this to view the latest report if you closed the test window.

* **Windows:** `.\ci_scripts\view_logs.ps1`
* **Linux:** `./ci_scripts/view_logs.sh`